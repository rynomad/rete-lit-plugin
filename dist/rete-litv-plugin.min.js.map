{"version":3,"file":"rete-litv-plugin.min.js","sources":["../src/renderer.ts","../src/presets/classic/components/Connection.ts","../src/presets/classic/components/ConnectionWrapper.ts","../src/presets/classic/vars.ts","../src/presets/classic/components/Control.ts","../src/presets/classic/components/Node.ts","../src/presets/classic/components/Socket.ts","../src/presets/classic/index.ts","../src/presets/context-menu/context-vars.ts","../src/presets/context-menu/utils/debounce.ts","../src/presets/context-menu/components/Block.ts","../src/presets/context-menu/components/Item.ts","../src/presets/context-menu/components/Search.ts","../src/presets/context-menu/components/Menu.ts","../src/presets/context-menu/index.ts","../src/presets/minimap/utils.ts","../src/presets/minimap/MiniNode.ts","../src/presets/minimap/MiniViewport.ts","../src/shared/drag.ts","../node_modules/fast-equals/dist/esm/index.mjs","../src/presets/minimap/Minimap.ts","../src/presets/minimap/index.ts","../src/presets/reroute/Pins.ts","../src/presets/reroute/index.ts","../src/Ref.ts","../src/index.ts"],"sourcesContent":["import { LitElement } from 'lit'\n\ntype Instance<P> = { app: LitElement; payload: P }\n\nfunction setProps(element: LitElement, payload: Record<string, any>) {\n  for (const key of Object.keys(payload)) {\n    if (key === 'styles') continue\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    element[key] = payload[key]\n  }\n}\n\nexport function create<P extends Record<string, any>>(\n  element: Element,\n  component: any,\n  payload: P,\n  onRendered: any\n): Instance<P> {\n  const state = payload\n\n  const app = new component()\n\n  app.addEventListener('updated', () => {\n    onRendered()\n  })\n\n  setProps(app, payload)\n\n  element.appendChild(app)\n\n  onRendered()\n\n  return {\n    app,\n    payload: state\n  }\n}\n\nexport function update<P extends object>(instance: Instance<P>, payload: P) {\n  instance.payload = { ...instance.payload, ...payload }\n  setProps(instance.app, instance.payload)\n  instance.app.requestUpdate()\n}\n\nexport function destroy(instance: Instance<unknown>) {\n  instance.app.remove()\n}\n\nexport type Renderer<I> = {\n    get(element: Element): I | undefined;\n    mount(\n        element: Element,\n        litComponent: any,\n        payload: object,\n        onRendered: any\n    ): I;\n    update(app: I, payload: object): void;\n    unmount(element: Element): void;\n}\n\nexport function getRenderer(): Renderer<Instance<object>> {\n  const instances = new Map<Element, Instance<object>>()\n\n  return {\n    get(element) {\n      return instances.get(element)\n    },\n    mount(element, litComponent, payload, onRendered) {\n      const app = create(element, litComponent, payload, onRendered)\n\n      instances.set(element, app)\n\n      return app\n    },\n    update(app, payload) {\n      update(app, payload)\n    },\n    unmount(element) {\n      const app = instances.get(element)\n\n      if (app) {\n        destroy(app)\n        instances.delete(element)\n      }\n    }\n  }\n}\n","import { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\n@customElement('connection-component')\nexport class Connection extends LitElement {\n  @property({ type: Object }) data = {}\n  @property({ type: Object }) start = {}\n  @property({ type: Object }) end = {}\n  @property({ type: String }) path = ''\n\n  static styles = css`\n    svg {\n      overflow: visible !important;\n      position: absolute;\n      pointer-events: none;\n      width: 9999px;\n      height: 9999px;\n    }\n    path {\n      fill: none;\n      stroke-width: 5px;\n      stroke: steelblue;\n      pointer-events: auto;\n    }\n  `\n\n  render() {\n    return html`\n      <svg data-testid=\"connection\">\n        <path d=${this.path}></path>\n      </svg>\n    `\n  }\n}\n","/* eslint-disable @typescript-eslint/ban-types */\nimport { html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\n@customElement('connection-wrapper')\nexport class ConnectionWrapper extends LitElement {\n    @property({ type: Object }) component: any\n    @property({ type: Object }) data: any\n    @property({ type: Object }) start: any\n    @property({ type: Object }) end: any\n    @property({ type: Function }) path: Function = () => {\n      throw new Error('PATH FUNCTION NOT SET PROPERLY')\n    }\n\n    observedStart = { x: 0, y: 0 }\n    observedEnd = { x: 0, y: 0 }\n    observedPath = ''\n    onDestroy: Function | null = null\n\n    constructor() {\n      super()\n    }\n\n    connectedCallback() {\n      super.connectedCallback()\n      this.initializeWatchers()\n      this.fetchPath()\n    }\n\n    disconnectedCallback() {\n      if (this.onDestroy) this.onDestroy()\n      super.disconnectedCallback()\n    }\n\n    initializeWatchers() {\n      const unwatch1 =\n            typeof this.start === 'function' &&\n            this.start((pos: any) => {\n              this.observedStart = pos\n              this.fetchPath() // Fetch the new path when start changes\n            })\n\n      const unwatch2 =\n            typeof this.end === 'function' &&\n            this.end((pos: any) => {\n              this.observedEnd = pos\n              this.fetchPath() // Fetch the new path when end changes\n            })\n\n      this.onDestroy = () => {\n        unwatch1 && unwatch1()\n        unwatch2 && unwatch2()\n      }\n    }\n\n    async fetchPath() {\n      if (this.startPosition && this.endPosition) {\n        this.observedPath = await this.path(\n          this.startPosition,\n          this.endPosition\n        )\n        this.requestUpdate() // Request re-render\n      }\n    }\n\n    get startPosition() {\n      return this.start && 'x' in this.start\n        ? this.start\n        : this.observedStart\n    }\n\n    get endPosition() {\n      return this.end && 'x' in this.end ? this.end : this.observedEnd\n    }\n\n    render() {\n      if (this.component) {\n        const dynamicComponent = new this.component()\n\n        dynamicComponent.data = this.data\n        dynamicComponent.start = this.startPosition\n        dynamicComponent.end = this.endPosition\n        dynamicComponent.path = this.observedPath\n\n        return html`${dynamicComponent}`\n      }\n\n      return html``\n    }\n}\n","import { css } from 'lit'\nexport default css`:host {\n    --node-color: rgba(110, 136, 255, 0.8);\n    --node-color-selected: #ffd92c;\n    --group-color: rgba(15, 80, 255, 0.2);\n    --group-handler-size: 40px;\n    --group-handler-offset: -10px;\n    --socket-size: 24px;\n    --socket-margin: 6px;\n    --socket-color: #96b38a;\n    --node-width: 180px;\n}`\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { css, html, LitElement } from 'lit'\nimport { property } from 'lit/decorators'\nimport { ClassicPreset } from 'rete'\n\nimport vars from '../vars'\n\nexport class Control<T extends 'text' | 'number'> extends LitElement {\n  @property({ type: ClassicPreset.InputControl }) data: ClassicPreset.InputControl<T> | undefined\n  static styles = [vars, css`\n    input {\n      width: 100%;\n      border-radius: 30px;\n      background-color: white;\n      padding: 2px 6px;\n      border: 1px solid #999;\n      font-size: 110%;\n      box-sizing: border-box;\n    }\n  `]\n\n  render() {\n    return html`\n      <input\n        type=\"${this.data?.type}\"\n        .value=\"${this.data?.value}\"\n        ?readonly=\"${this.data?.readonly}\"\n        @input=\"${this.change}\"\n        @pointerdown=\"${this.stopEvent}\"\n      />\n    `\n  }\n\n  change(e: Event) {\n    const val = this.data?.type === 'number'\n      ? +(e.target as HTMLInputElement)?.value\n      : (e.target as HTMLInputElement)?.value\n\n    // @ts-ignore\n    this.data?.setValue(val)\n  }\n\n  stopEvent(e: Event) {\n    e.stopPropagation()\n  }\n}\n\ncustomElements.define('control-component', Control)\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\nimport { ClassicPreset } from 'rete'\nimport { Socket } from 'rete/_types/presets/classic'\n\nimport vars from '../vars'\n\nfunction sortByIndex(entries: any = []) {\n  entries.sort((a: any, b: any) => {\n    const ai = (a[1] && a[1].index) || 0\n    const bi = (b[1] && b[1].index) || 0\n\n    return ai - bi\n  })\n  return entries\n}\n\n@customElement('node-component')\nexport class Node extends LitElement {\n    @property({ type: Object }) data:\n      | ClassicPreset.Node\n        | undefined\n    @property({ type: Function }) emit = () => {\n      throw new Error('emit not set properly')\n    }\n    @property({ type: String }) seed = ''\n\n    nodeStyles() {\n      // @ts-ignore\n      return `width: ${this.data?.width || '100px'}; height: ${\n        // @ts-ignore\n        this.data?.height || '100px'\n      }`\n    }\n\n    inputs() {\n      // @ts-ignore\n      return sortByIndex(Object.entries(this.data?.inputs || {}))\n    }\n\n    controls() {\n      // @ts-ignore\n      return sortByIndex(Object.entries(this.data?.controls || {}))\n    }\n\n    outputs() {\n      // @ts-ignore\n      return sortByIndex(Object.entries(this.data?.outputs || {}))\n    }\n\n    static styles = [\n      vars,\n      css`\n            :host {\n                display: block;\n            }\n\n            .node {\n                background: var(--node-color);\n                border: 2px solid #4e58bf;\n                border-radius: 10px;\n                cursor: pointer;\n                box-sizing: border-box;\n                width: var(--node-width);\n                height: auto;\n                padding-bottom: 6px;\n                position: relative;\n                user-select: none;\n                line-height: initial;\n                font-family: Arial;\n            }\n\n            .node:hover {\n                background: linear-gradient(\n                        rgba(255, 255, 255, 0.04),\n                        rgba(255, 255, 255, 0.04)\n                    ),\n                    var(--node-color);\n            }\n\n            .node.selected {\n                background: var(--node-color-selected);\n                border-color: #e3c000;\n            }\n\n            .node .title {\n                color: white;\n                font-family: sans-serif;\n                font-size: 18px;\n                padding: 8px;\n            }\n\n            .node .output {\n                text-align: right;\n            }\n            .node .input {\n                text-alight: left;\n            }\n\n            .node .input-socket {\n                text-align: left;\n                margin-left: calc(\n                    (var(--socket-size) / -2) - var(--socket-margin)\n                );\n                display: inline-block;\n            }\n\n            .node .output-socket {\n                text-align: right;\n                margin-right: calc(\n                    (var(--socket-size) / -2) - var(--socket-margin)\n                );\n                display: inline-block;\n            }\n\n            .node .input-title,\n            .node .output-title {\n                vertical-align: middle;\n                color: white;\n                display: inline-block;\n                font-family: sans-serif;\n                font-size: 14px;\n                margin: var(--socket-margin);\n                line-height: var(--socket-size);\n            }\n\n            .node .input-control {\n                z-index: 1;\n                width: calc(\n                    100% - var(--socket-size) - 2 * var(--socket-margin)\n                );\n                vertical-align: middle;\n                display: inline-block;\n            }\n\n            .node .input-title[hidden],\n            .node .output-title[hidden] {\n                display: none;\n            }\n\n            .node .control {\n                padding: var(--socket-margin)\n                    calc(var(--socket-size) / 2 + var(--socket-margin));\n                display: block;\n                margin: -4px;\n            }\n        `\n    ]\n\n    render() {\n      return html`\n            <div\n                class=\"node ${this.data?.selected ? 'selected' : ''}\"\n                style=${this.nodeStyles()}\n                data-testid=\"node\"\n            >\n                <div class=\"title\" data-testid=\"title\">${this.data?.label}</div>\n\n                <!-- Outputs -->\n                ${this.outputs().map(\n    ([key, output]:\n                        | string\n                        | ClassicPreset.Output<Socket>[]) => html`\n                        <div class=\"output\" data-testid=\"output-${key}\">\n                            <div\n                                class=\"output-title\"\n                                data-testid=\"output-title\"\n                            >\n                                ${(output as ClassicPreset.Output<Socket>)\n    .label}\n                            </div>\n                            <ref-element\n                                class=\"output-socket\"\n                                .data=${{\n    type: 'socket',\n    side: 'output',\n    key: key,\n    nodeId: this.data?.id,\n    payload: (\n                                        output as ClassicPreset.Output<Socket>\n    ).socket\n  }}\n                                .emit=${this.emit}\n                                data-testid=\"output-socket\"\n                            ></ref-element>\n                        </div>\n                    `\n  )}\n\n                <!-- Controls -->\n                ${this.controls().map(\n    ([key, control]: string | ClassicPreset.Control[]) => html`\n                        <ref-element\n                            data-testid=\"control-${key}\"\n                            class=\"control\"\n                            .emit=${this.emit}\n                            .data=${{ type: 'control', payload: control }}\n                        ></ref-element>\n                    `\n  )}\n\n                <!-- Inputs -->\n                ${this.inputs().map(\n    ([key, input]:\n                        | string\n                        | ClassicPreset.Input<Socket>[]) => html`\n                        <div class=\"input\" data-testid=\"input-${key}\">\n                            <ref-element\n                                class=\"input-socket\"\n                                .data=${{\n    type: 'socket',\n    side: 'input',\n    key: key,\n    nodeId: this.data?.id,\n    payload: (\n                                        input as ClassicPreset.Input<Socket>\n    ).socket\n  }}\n                                .emit=${this.emit}\n                                data-testid=\"input-socket\"\n                            ></ref-element>\n                            <div\n                                class=\"input-title\"\n                                ?hidden=${(input as ClassicPreset.Input<Socket>)\n    .control &&\n                                (input as ClassicPreset.Input<Socket>)\n                                  .showControl}\n                                data-testid=\"input-title\"\n                            >\n                                ${(input as ClassicPreset.Input<Socket>).label}\n                            </div>\n                            <ref-element\n                                ?hidden=${!(\n                                    input as ClassicPreset.Input<Socket>\n  ).control &&\n                                (input as ClassicPreset.Input<Socket>)\n                                  .showControl}\n                                .emit=${this.emit}\n                                .data=${{\n    type: 'control',\n    payload: (\n                                        input as ClassicPreset.Input<Socket>\n    ).control\n  }}\n                                data-testid=\"input-control\"\n                                class=\"input-control\"\n                            ></ref-element>\n                        </div>\n                    `\n  )}\n            </div>\n        `\n    }\n}\n","import { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\nimport { ClassicPreset } from 'rete'\n\nimport vars from '../vars'\n\n@customElement('socket-component')\nexport class Socket extends LitElement {\n    @property({ type: ClassicPreset.Socket }) data:\n        | ClassicPreset.Socket\n        | undefined\n\n    static styles = [\n      vars,\n      css`\n            :host {\n                display: inline-block;\n                cursor: pointer;\n                border: 1px solid white;\n                border-radius: calc(var(--socket-size) / 2);\n                width: var(--socket-size);\n                height: var(--socket-size);\n                margin: var(--socket-margin);\n                vertical-align: middle;\n                background: var(--socket-color);\n                z-index: 2;\n                box-sizing: border-box;\n            }\n            :host(:hover) {\n                border-width: 4px;\n            }\n            :host(.multiple) {\n                border-color: yellow;\n            }\n            :host(.output) {\n                margin-right: calc(var(--socket-size) / -2);\n            }\n            :host(.input) {\n                margin-left: calc(var(--socket-size) / -2);\n            }\n        `\n    ]\n\n    // Define the click handler function\n    handleClick() {\n      // eslint-disable-next-line\n      console.log('Socket has been clicked')\n    }\n\n    render() {\n      return html`\n            <div\n                class=\"socket\"\n                title=\"${this.data?.name}\"\n                @click=\"${this.handleClick}\"\n            ></div>\n        `\n    }\n}\n","import { LitElement } from 'lit'\nimport { ClassicPreset, Scope } from 'rete'\nimport { classicConnectionPath, getDOMSocketPosition, loopConnectionPath, SocketPositionWatcher } from 'rete-render-utils'\n\nimport { Position } from '../../types'\nimport { RenderPreset } from '../types'\nimport { Connection } from './components/Connection'\nimport { ConnectionWrapper } from './components/ConnectionWrapper'\nimport { Control } from './components/Control'\nimport { Node } from './components/Node'\nimport { Socket } from './components/Socket'\nimport { ClassicScheme, ExtractPayload, LitArea2D } from './types'\n\nexport { Connection } from './components/Connection'\nexport { Control } from './components/Control'\nexport { Node } from './components/Node'\nexport { Socket } from './components/Socket'\n\ntype Component<Props extends Record<string, any>> =\n  | typeof LitElement\n  | { new(): LitElement & Props }\n\ntype CustomizationProps<Schemes extends ClassicScheme> = {\n  node?: (data: ExtractPayload<Schemes, 'node'>) => Component<any> | null\n  connection?: (data: ExtractPayload<Schemes, 'connection'>) => Component<any> | null\n  socket?: (data: ExtractPayload<Schemes, 'socket'>) => Component<any> | null\n  control?: (data: ExtractPayload<Schemes, 'control'>) => Component<any> | null\n}\ntype ClassicProps<Schemes extends ClassicScheme, K> = {\n  socketPositionWatcher?: SocketPositionWatcher<Scope<never, [K]>>,\n  customize?: CustomizationProps<Schemes>\n}\n\n/**\n * Classic preset for rendering nodes, connections, controls and sockets.\n */\nexport function setup<Schemes extends ClassicScheme, K extends LitArea2D<Schemes>>(\n  props?: ClassicProps<Schemes, K>\n): RenderPreset<Schemes, K> {\n  const positionWatcher = typeof props?.socketPositionWatcher === 'undefined'\n    ? getDOMSocketPosition<Schemes, K>()\n    : props?.socketPositionWatcher\n  const { node, connection, socket, control } = props?.customize || {}\n\n  return {\n    attach(plugin) {\n      positionWatcher.attach(plugin as unknown as Scope<never, [K]>)\n    },\n    update(context, plugin) {\n      const { payload } = context.data\n      const parent = plugin.parentScope()\n\n      if (!parent) throw new Error('parent')\n      const emit = parent.emit.bind(parent)\n\n      if (context.data.type === 'node') {\n        return { data: payload, emit }\n      } else if (context.data.type === 'connection') {\n        const { start, end } = context.data\n\n        return {\n          data: payload,\n          ...(start ? { start } : {}),\n          ...(end ? { end } : {})\n        }\n      }\n      return { data: payload }\n    },\n    // eslint-disable-next-line max-statements, complexity\n    render(context, plugin) {\n      const parent = plugin.parentScope()\n      const emit = parent.emit.bind(parent)\n\n      if (context.data.type === 'node') {\n        const component = node ? node(context.data) : Node\n\n        return component && {\n          component, props: {\n            data: context.data.payload,\n            emit\n          }\n        }\n      } else if (context.data.type === 'connection') {\n        const component = connection ? connection(context.data) : Connection\n        const { payload } = context.data\n        const { source, target, sourceOutput, targetInput } = payload\n\n        return component && {\n          component: ConnectionWrapper, props: {\n            data: context.data.payload,\n            component,\n            start: context.data.start || ((change: any) => positionWatcher.listen(source, 'output', sourceOutput, change)),\n            end: context.data.end || ((change: any) => positionWatcher.listen(target, 'input', targetInput, change)),\n            path: async (start: Position, end: Position) => {\n              const response = await plugin.emit({ type: 'connectionpath', data: { payload, points: [start, end] } })\n\n              if (!response) return ''\n\n              const { path, points } = response.data\n              const curvature = 0.3\n\n              if (!path && points.length !== 2) throw new Error('cannot render connection with a custom number of points')\n              if (!path) return payload.isLoop\n                ? loopConnectionPath(points as [Position, Position], curvature, 120)\n                : classicConnectionPath(points as [Position, Position], curvature)\n\n              return path\n            }\n          }\n        }\n      } else if (context.data.type === 'socket') {\n        const { payload } = context.data\n        const component = socket ? socket(context.data) : Socket\n\n        return {\n          component, props: {\n            data: payload\n          }\n        }\n      } else if (context.data.type === 'control') {\n        const { payload } = context.data\n\n        if (control) {\n          const component = control(context.data)\n\n          return component && {\n            component, props: {\n              data: payload\n            }\n          }\n        }\n\n        return context.data.payload instanceof ClassicPreset.InputControl\n          ? {\n            component: Control, props: {\n              data: payload\n            }\n          }\n          : null\n      }\n    }\n  }\n}\n","import { css } from 'lit'\nexport default css`:host {\n    --context-color: rgba(110, 136, 255, 0.8);\n    --context-color-light: rgba(130, 153, 255, 0.8);\n    --context-color-dark: rgba(69, 103, 255, 0.8);\n    --context-menu-round: 5px;\n    --width: 120px;\n    --test: 23px;\n}`\n","export function debounce(delay: number, cb: () => void) {\n  return {\n    timeout: null as null | number,\n    cancel() {\n      if (this.timeout) {\n        window.clearTimeout(this.timeout)\n        this.timeout = null\n      }\n    },\n    call() {\n      this.timeout = window.setTimeout(() => {\n        cb()\n      }, delay)\n    }\n  }\n}\n","import '../context-vars'\n\nimport { css, html, LitElement } from 'lit'\nimport { customElement } from 'lit/decorators'\n\nimport vars from '../context-vars'\n\n@customElement('block-component')\nexport class Block extends LitElement {\n  static styles = [vars, css`\n    :host {\n      color: #fff;\n      padding: 4px;\n      border-bottom: 1px solid var(--context-color-dark);\n      background-color: var(--context-color);\n      cursor: pointer;\n      box-sizing: border-box;\n      width: 100%;\n      position: relative;\n    }\n\n    :host(:first-child) {\n      border-top-left-radius: var(--context-menu-round);\n      border-top-right-radius: var(--context-menu-round);\n    }\n\n    :host(:last-child) {\n      border-bottom-left-radius: var(--context-menu-round);\n      border-bottom-right-radius: var(--context-menu-round);\n    }\n\n    :host(:hover) {\n      background-color: var(--context-color-light);\n    }\n  `]\n\n  render() {\n    return html`\n      <slot></slot>\n    `\n  }\n}\n","import './Block'\n\nimport { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\nimport vars from '../context-vars'\nimport { Item as ItemType } from '../types'\nimport { debounce } from '../utils/debounce'\n\n@customElement('item-component')\nexport class Item extends LitElement {\n  @property({ type: Array }) subitems: ItemType[] = []\n  @property({ type: Number }) delay = 0\n  @property({ type: Boolean }) visibleSubitems = false\n  hide: any\n\n  constructor() {\n    super()\n    this.hide = debounce(this.delay, this.hideSubitems.bind(this))\n  }\n\n  hideSubitems() {\n    this.visibleSubitems = false\n  }\n\n  render() {\n    return html`\n      <block-component class=\"block ${this.subitems ? 'hasSubitems' : ''}\" data-testid=\"context-menu-item\">\n        <div \n          class=\"content\"\n          @click=\"${(event: Event) => { this.dispatchEvent(new CustomEvent('select', { detail: event })); this.dispatchEvent(new CustomEvent('hide')) }}\"\n          @wheel=\"${(event: Event) => event.stopPropagation()}\"\n          @pointerover=\"${() => { this.hide.cancel(); this.visibleSubitems = true }}\"\n          @pointerleave=\"${() => this.hide.call(this)}\"\n          @pointerdown=\"${(event: Event) => event.stopPropagation()}\"\n        >\n          <slot></slot>\n          ${this.subitems && this.visibleSubitems ? html`\n            <div class=\"subitems\">\n              ${this.subitems.map((item) => html`\n                <item-component\n                  @select=\"${(event: Event) => item.handler(event)}\"\n                  .delay=\"${this.delay}\"\n                  @hide=\"${() => this.dispatchEvent(new CustomEvent('hide'))}\"\n                  .subitems=\"${item.subitems}\"\n                >${item.label}</item-component>\n              `)}\n            </div>\n          ` : ''}\n        </div>\n      </block-component>\n    `\n  }\n\n  static styles = [vars, css`\n\n    .block {\n      padding: 0;\n    }\n\n    .content {\n      padding: 4px;\n      background-color: var(--context-color);\n    }\n\n    .hasSubitems:after {\n      content: '►';\n      position: absolute;\n      opacity: 0.6;\n      right: 5px;\n      top: 5px;\n    }\n\n    .subitems {\n      position: absolute;\n      top: 0;\n      left: 100%;\n      width: var(--width);\n    }\n  `]\n}\n","import { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\n@customElement('search-component')\nexport class Search extends LitElement {\n  @property({ type: String }) text = ''\n\n  static styles = css`\n    .search {\n      color: white;\n      padding: 1px 8px;\n      border: 1px solid white;\n      border-radius: 10px;\n      font-size: 16px;\n      font-family: serif;\n      width: 100%;\n      box-sizing: border-box;\n      background: transparent;\n    }\n  `\n\n  render() {\n    return html`\n      <input class=\"search\" \n        .value=\"${this.text}\" \n        @input=\"${this.handleInput}\" \n        data-testid=\"context-menu-search-input\">\n      </input>\n    `\n  }\n\n  handleInput(e: Event) {\n    this.text = (e.target as HTMLInputElement).value\n    this.dispatchEvent(new CustomEvent('change', { detail: this.text }))\n  }\n}\n","import { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\nimport vars from '../context-vars'\nimport { Item } from '../types'\nimport { debounce } from '../utils/debounce'\n\n@customElement('menu-component')\nexport class Menu extends LitElement {\n  @property({ type: Array }) items: Item[] = []\n  @property({ type: Number }) delay = 0\n  @property({ type: Boolean }) searchBar = false\n  // eslint-disable-next-line\n  @property({ type: Function }) onHide = () => { }\n  @property({ type: String }) seed = ''\n  @property({ type: String }) filter = ''\n\n  hide: any\n\n  constructor() {\n    super()\n    this.hide = debounce(this.delay, this.onHide)\n  }\n\n  getItems() {\n    const filterRegexp = new RegExp(this.filter, 'i')\n    const filteredList = this.items.filter(item => (\n      item.label.match(filterRegexp)\n    ))\n\n    return filteredList\n  }\n\n  connectedCallback() {\n    super.connectedCallback()\n  }\n\n  disconnectedCallback() {\n    if (this.hide) this.hide.cancel()\n    super.disconnectedCallback()\n  }\n\n  render() {\n    return html`\n        <div\n            class=\"menu\"\n            @mouseover=\"${this.hide.cancel}\"\n            @mouseleave=\"${this.hide.call}\"\n            data-testid=\"context-menu\"\n            rete-context-menu\n        >\n            ${this.searchBar\n    ? html`\n                      <block-component>\n                          <search-component\n                              .text=\"${this.filter}\"\n                              @change=\"${(e: Event) =>\n    (this.filter = (e as CustomEvent).detail)}\"\n                          ></search-component>\n                      </block-component>\n                  `\n    : ''}\n            ${this.getItems().map(\n    (item) => html`\n                    <item-component\n                        @select=\"${item.handler}\"\n                        .delay=\"${this.delay}\"\n                        @hide=\"${this.onHide}\"\n                        .subitems=\"${item.subitems}\"\n                    >\n                        ${item.label}\n                    </item-component>\n                `\n  )}\n        </div>\n    `\n  }\n\n  static styles =[vars, css`\n\n    .menu {\n      padding: 10px;\n      width: var(--width);\n      margin-top: -20px;\n      margin-left: calc(var(--width) / -2);\n    }\n  `]\n}\n","import './components/Item'\nimport './components/Block'\nimport './components/Search'\n\nimport { BaseSchemes } from 'rete'\n\nimport { RenderPreset } from '../types'\nimport { Menu } from './components/Menu'\nimport { ContextMenuRender } from './types'\n\nexport function setup<Schemes extends BaseSchemes, K extends ContextMenuRender>(props?: { delay?: number }): RenderPreset<Schemes, K> {\n  const delay = typeof props?.delay === 'undefined' ? 1000 : props.delay\n\n  return {\n    update(context) {\n      if (context.data.type === 'contextmenu') {\n        return {\n          items: context.data.items,\n          delay,\n          searchBar: context.data.searchBar,\n          onHide: context.data.onHide\n        }\n      }\n    },\n    render(context) {\n      if (context.data.type === 'contextmenu') {\n        return {\n          component: Menu,\n          props: {\n            items: context.data.items,\n            delay,\n            searchBar: context.data.searchBar,\n            onHide: context.data.onHide\n          }\n        }\n      }\n    }\n  }\n}\n","export function px(value: number) {\n  return `${value}px`\n}\n","import { css, html, LitElement } from 'lit'\nimport { property } from 'lit/decorators'\nimport { styleMap } from 'lit/directives/style-map'\n\nimport { px } from './utils'\n\nexport type MiniNodeType = {\n  left: number;\n  top: number;\n  width: number;\n  height: number;\n}\n\nexport class MiniNode extends LitElement {\n  @property({ type: Number }) left = 0\n  @property({ type: Number }) top = 0\n  @property({ type: Number }) width = 0\n  @property({ type: Number }) height = 0\n\n  static styles = css`\n    .mini-node {\n      position: absolute;\n      background: rgba(110, 136, 255, 0.8);\n      border: 1px solid rgb(192 206 212 / 60%);\n    }\n  `\n\n  get styles() {\n    return {\n      left: px(this.left),\n      top: px(this.top),\n      width: px(this.width),\n      height: px(this.height)\n    }\n  }\n\n  render() {\n    return html`\n      <div class=\"mini-node\" style=${styleMap(this.styles)}></div>\n    `\n  }\n}\n\ncustomElements.define('mini-node', MiniNode)\n","import { css, html, LitElement } from 'lit'\nimport { property } from 'lit/decorators'\n\nimport { useDrag } from '../../shared/drag'\nimport { px } from './utils'\n\nexport class MiniViewport extends LitElement {\n  @property({ type: Number }) left = 0\n  @property({ type: Number }) top = 0\n  @property({ type: Number }) width = 0\n  @property({ type: Number }) height = 0\n  @property({ type: Number }) containerWidth = 0\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  @property({ type: Function }) reTranslate = (_x: any, _y: any) => { throw new Error('TRANSLATE NOT SET PROPERLY IN MiniViewport')}\n\n  drag = useDrag(this.onDrag, e => ({ x: e.pageX, y: e.pageY }))\n\n  scale(v: number) {\n    return v * this.containerWidth\n  }\n\n  invert(v: number) {\n    return v / this.containerWidth\n  }\n\n  onDrag(dx: number, dy: number) {\n    this.reTranslate(this.invert(-dx), this.invert(-dy))\n  }\n\n  get styles() {\n    return {\n      left: px(this.scale(this.left)),\n      top: px(this.scale(this.top)),\n      width: px(this.scale(this.width)),\n      height: px(this.scale(this.height))\n    }\n  }\n\n  render() {\n    return html`\n      <div\n        class=\"mini-viewport\"\n        @pointerdown=${this.drag.start}\n        style=${this.styles}\n        data-testid=\"minimap-viewport\"\n      ></div>\n    `\n  }\n\n  static styles = css`\n    .mini-viewport {\n      position: absolute;\n      background: rgba(255, 251, 128, 0.32);\n      border: 1px solid #ffe52b;\n    }\n  `\n}\n\ncustomElements.define('mini-viewport', MiniViewport)\n","import { Position } from '../types'\n\ntype Translate = (dx: number, dy: number) => void\ntype StartEvent = { pageX: number, pageY: number }\n\nexport function useDrag(translate: Translate, getPointer: (e: StartEvent) => Position) {\n  return {\n    start(e: StartEvent) {\n      let previous = { ...getPointer(e) }\n\n      function move(moveEvent: MouseEvent) {\n        const current = { ...getPointer(moveEvent) }\n        const dx = current.x - previous.x\n        const dy = current.y - previous.y\n\n        previous = current\n\n        translate(dx, dy)\n      }\n      function up() {\n        window.removeEventListener('pointermove', move)\n        window.removeEventListener('pointerup', up)\n        window.removeEventListener('pointercancel', up)\n      }\n\n      window.addEventListener('pointermove', move)\n      window.addEventListener('pointerup', up)\n      window.addEventListener('pointercancel', up)\n    }\n  }\n}\n","var getOwnPropertyNames = Object.getOwnPropertyNames, getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n/**\n * Combine two comparators into a single comparators.\n */\nfunction combineComparators(comparatorA, comparatorB) {\n    return function isEqual(a, b, state) {\n        return comparatorA(a, b, state) && comparatorB(a, b, state);\n    };\n}\n/**\n * Wrap the provided `areItemsEqual` method to manage the circular state, allowing\n * for circular references to be safely included in the comparison without creating\n * stack overflows.\n */\nfunction createIsCircular(areItemsEqual) {\n    return function isCircular(a, b, state) {\n        if (!a || !b || typeof a !== 'object' || typeof b !== 'object') {\n            return areItemsEqual(a, b, state);\n        }\n        var cache = state.cache;\n        var cachedA = cache.get(a);\n        var cachedB = cache.get(b);\n        if (cachedA && cachedB) {\n            return cachedA === b && cachedB === a;\n        }\n        cache.set(a, b);\n        cache.set(b, a);\n        var result = areItemsEqual(a, b, state);\n        cache.delete(a);\n        cache.delete(b);\n        return result;\n    };\n}\n/**\n * Get the properties to strictly examine, which include both own properties that are\n * not enumerable and symbol properties.\n */\nfunction getStrictProperties(object) {\n    return getOwnPropertyNames(object).concat(getOwnPropertySymbols(object));\n}\n/**\n * Whether the object contains the property passed as an own property.\n */\nvar hasOwn = Object.hasOwn ||\n    (function (object, property) {\n        return hasOwnProperty.call(object, property);\n    });\n/**\n * Whether the values passed are strictly equal or both NaN.\n */\nfunction sameValueZeroEqual(a, b) {\n    return a || b ? a === b : a === b || (a !== a && b !== b);\n}\n\nvar OWNER = '_owner';\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor, keys = Object.keys;\n/**\n * Whether the arrays are equal in value.\n */\nfunction areArraysEqual(a, b, state) {\n    var index = a.length;\n    if (b.length !== index) {\n        return false;\n    }\n    while (index-- > 0) {\n        if (!state.equals(a[index], b[index], index, index, a, b, state)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Whether the dates passed are equal in value.\n */\nfunction areDatesEqual(a, b) {\n    return sameValueZeroEqual(a.getTime(), b.getTime());\n}\n/**\n * Whether the `Map`s are equal in value.\n */\nfunction areMapsEqual(a, b, state) {\n    if (a.size !== b.size) {\n        return false;\n    }\n    var matchedIndices = {};\n    var aIterable = a.entries();\n    var index = 0;\n    var aResult;\n    var bResult;\n    while ((aResult = aIterable.next())) {\n        if (aResult.done) {\n            break;\n        }\n        var bIterable = b.entries();\n        var hasMatch = false;\n        var matchIndex = 0;\n        while ((bResult = bIterable.next())) {\n            if (bResult.done) {\n                break;\n            }\n            var _a = aResult.value, aKey = _a[0], aValue = _a[1];\n            var _b = bResult.value, bKey = _b[0], bValue = _b[1];\n            if (!hasMatch &&\n                !matchedIndices[matchIndex] &&\n                (hasMatch =\n                    state.equals(aKey, bKey, index, matchIndex, a, b, state) &&\n                        state.equals(aValue, bValue, aKey, bKey, a, b, state))) {\n                matchedIndices[matchIndex] = true;\n            }\n            matchIndex++;\n        }\n        if (!hasMatch) {\n            return false;\n        }\n        index++;\n    }\n    return true;\n}\n/**\n * Whether the objects are equal in value.\n */\nfunction areObjectsEqual(a, b, state) {\n    var properties = keys(a);\n    var index = properties.length;\n    if (keys(b).length !== index) {\n        return false;\n    }\n    var property;\n    // Decrementing `while` showed faster results than either incrementing or\n    // decrementing `for` loop and than an incrementing `while` loop. Declarative\n    // methods like `some` / `every` were not used to avoid incurring the garbage\n    // cost of anonymous callbacks.\n    while (index-- > 0) {\n        property = properties[index];\n        if (property === OWNER &&\n            (a.$$typeof || b.$$typeof) &&\n            a.$$typeof !== b.$$typeof) {\n            return false;\n        }\n        if (!hasOwn(b, property) ||\n            !state.equals(a[property], b[property], property, property, a, b, state)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Whether the objects are equal in value with strict property checking.\n */\nfunction areObjectsEqualStrict(a, b, state) {\n    var properties = getStrictProperties(a);\n    var index = properties.length;\n    if (getStrictProperties(b).length !== index) {\n        return false;\n    }\n    var property;\n    var descriptorA;\n    var descriptorB;\n    // Decrementing `while` showed faster results than either incrementing or\n    // decrementing `for` loop and than an incrementing `while` loop. Declarative\n    // methods like `some` / `every` were not used to avoid incurring the garbage\n    // cost of anonymous callbacks.\n    while (index-- > 0) {\n        property = properties[index];\n        if (property === OWNER &&\n            (a.$$typeof || b.$$typeof) &&\n            a.$$typeof !== b.$$typeof) {\n            return false;\n        }\n        if (!hasOwn(b, property)) {\n            return false;\n        }\n        if (!state.equals(a[property], b[property], property, property, a, b, state)) {\n            return false;\n        }\n        descriptorA = getOwnPropertyDescriptor(a, property);\n        descriptorB = getOwnPropertyDescriptor(b, property);\n        if ((descriptorA || descriptorB) &&\n            (!descriptorA ||\n                !descriptorB ||\n                descriptorA.configurable !== descriptorB.configurable ||\n                descriptorA.enumerable !== descriptorB.enumerable ||\n                descriptorA.writable !== descriptorB.writable)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Whether the primitive wrappers passed are equal in value.\n */\nfunction arePrimitiveWrappersEqual(a, b) {\n    return sameValueZeroEqual(a.valueOf(), b.valueOf());\n}\n/**\n * Whether the regexps passed are equal in value.\n */\nfunction areRegExpsEqual(a, b) {\n    return a.source === b.source && a.flags === b.flags;\n}\n/**\n * Whether the `Set`s are equal in value.\n */\nfunction areSetsEqual(a, b, state) {\n    if (a.size !== b.size) {\n        return false;\n    }\n    var matchedIndices = {};\n    var aIterable = a.values();\n    var aResult;\n    var bResult;\n    while ((aResult = aIterable.next())) {\n        if (aResult.done) {\n            break;\n        }\n        var bIterable = b.values();\n        var hasMatch = false;\n        var matchIndex = 0;\n        while ((bResult = bIterable.next())) {\n            if (bResult.done) {\n                break;\n            }\n            if (!hasMatch &&\n                !matchedIndices[matchIndex] &&\n                (hasMatch = state.equals(aResult.value, bResult.value, aResult.value, bResult.value, a, b, state))) {\n                matchedIndices[matchIndex] = true;\n            }\n            matchIndex++;\n        }\n        if (!hasMatch) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Whether the TypedArray instances are equal in value.\n */\nfunction areTypedArraysEqual(a, b) {\n    var index = a.length;\n    if (b.length !== index) {\n        return false;\n    }\n    while (index-- > 0) {\n        if (a[index] !== b[index]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nvar ARGUMENTS_TAG = '[object Arguments]';\nvar BOOLEAN_TAG = '[object Boolean]';\nvar DATE_TAG = '[object Date]';\nvar MAP_TAG = '[object Map]';\nvar NUMBER_TAG = '[object Number]';\nvar OBJECT_TAG = '[object Object]';\nvar REG_EXP_TAG = '[object RegExp]';\nvar SET_TAG = '[object Set]';\nvar STRING_TAG = '[object String]';\nvar isArray = Array.isArray;\nvar isTypedArray = typeof ArrayBuffer === 'function' && ArrayBuffer.isView\n    ? ArrayBuffer.isView\n    : null;\nvar assign = Object.assign;\nvar getTag = Object.prototype.toString.call.bind(Object.prototype.toString);\n/**\n * Create a comparator method based on the type-specific equality comparators passed.\n */\nfunction createEqualityComparator(_a) {\n    var areArraysEqual = _a.areArraysEqual, areDatesEqual = _a.areDatesEqual, areMapsEqual = _a.areMapsEqual, areObjectsEqual = _a.areObjectsEqual, arePrimitiveWrappersEqual = _a.arePrimitiveWrappersEqual, areRegExpsEqual = _a.areRegExpsEqual, areSetsEqual = _a.areSetsEqual, areTypedArraysEqual = _a.areTypedArraysEqual;\n    /**\n     * compare the value of the two objects and return true if they are equivalent in values\n     */\n    return function comparator(a, b, state) {\n        // If the items are strictly equal, no need to do a value comparison.\n        if (a === b) {\n            return true;\n        }\n        // If the items are not non-nullish objects, then the only possibility\n        // of them being equal but not strictly is if they are both `NaN`. Since\n        // `NaN` is uniquely not equal to itself, we can use self-comparison of\n        // both objects, which is faster than `isNaN()`.\n        if (a == null ||\n            b == null ||\n            typeof a !== 'object' ||\n            typeof b !== 'object') {\n            return a !== a && b !== b;\n        }\n        var constructor = a.constructor;\n        // Checks are listed in order of commonality of use-case:\n        //   1. Common complex object types (plain object, array)\n        //   2. Common data values (date, regexp)\n        //   3. Less-common complex object types (map, set)\n        //   4. Less-common data values (promise, primitive wrappers)\n        // Inherently this is both subjective and assumptive, however\n        // when reviewing comparable libraries in the wild this order\n        // appears to be generally consistent.\n        // Constructors should match, otherwise there is potential for false positives\n        // between class and subclass or custom object and POJO.\n        if (constructor !== b.constructor) {\n            return false;\n        }\n        // `isPlainObject` only checks against the object's own realm. Cross-realm\n        // comparisons are rare, and will be handled in the ultimate fallback, so\n        // we can avoid capturing the string tag.\n        if (constructor === Object) {\n            return areObjectsEqual(a, b, state);\n        }\n        // `isArray()` works on subclasses and is cross-realm, so we can avoid capturing\n        // the string tag or doing an `instanceof` check.\n        if (isArray(a)) {\n            return areArraysEqual(a, b, state);\n        }\n        // `isTypedArray()` works on all possible TypedArray classes, so we can avoid\n        // capturing the string tag or comparing against all possible constructors.\n        if (isTypedArray != null && isTypedArray(a)) {\n            return areTypedArraysEqual(a, b, state);\n        }\n        // Try to fast-path equality checks for other complex object types in the\n        // same realm to avoid capturing the string tag. Strict equality is used\n        // instead of `instanceof` because it is more performant for the common\n        // use-case. If someone is subclassing a native class, it will be handled\n        // with the string tag comparison.\n        if (constructor === Date) {\n            return areDatesEqual(a, b, state);\n        }\n        if (constructor === RegExp) {\n            return areRegExpsEqual(a, b, state);\n        }\n        if (constructor === Map) {\n            return areMapsEqual(a, b, state);\n        }\n        if (constructor === Set) {\n            return areSetsEqual(a, b, state);\n        }\n        // Since this is a custom object, capture the string tag to determing its type.\n        // This is reasonably performant in modern environments like v8 and SpiderMonkey.\n        var tag = getTag(a);\n        if (tag === DATE_TAG) {\n            return areDatesEqual(a, b, state);\n        }\n        if (tag === REG_EXP_TAG) {\n            return areRegExpsEqual(a, b, state);\n        }\n        if (tag === MAP_TAG) {\n            return areMapsEqual(a, b, state);\n        }\n        if (tag === SET_TAG) {\n            return areSetsEqual(a, b, state);\n        }\n        if (tag === OBJECT_TAG) {\n            // The exception for value comparison is custom `Promise`-like class instances. These should\n            // be treated the same as standard `Promise` objects, which means strict equality, and if\n            // it reaches this point then that strict equality comparison has already failed.\n            return (typeof a.then !== 'function' &&\n                typeof b.then !== 'function' &&\n                areObjectsEqual(a, b, state));\n        }\n        // If an arguments tag, it should be treated as a standard object.\n        if (tag === ARGUMENTS_TAG) {\n            return areObjectsEqual(a, b, state);\n        }\n        // As the penultimate fallback, check if the values passed are primitive wrappers. This\n        // is very rare in modern JS, which is why it is deprioritized compared to all other object\n        // types.\n        if (tag === BOOLEAN_TAG || tag === NUMBER_TAG || tag === STRING_TAG) {\n            return arePrimitiveWrappersEqual(a, b, state);\n        }\n        // If not matching any tags that require a specific type of comparison, then we hard-code false because\n        // the only thing remaining is strict equality, which has already been compared. This is for a few reasons:\n        //   - Certain types that cannot be introspected (e.g., `WeakMap`). For these types, this is the only\n        //     comparison that can be made.\n        //   - For types that can be introspected, but rarely have requirements to be compared\n        //     (`ArrayBuffer`, `DataView`, etc.), the cost is avoided to prioritize the common\n        //     use-cases (may be included in a future release, if requested enough).\n        //   - For types that can be introspected but do not have an objective definition of what\n        //     equality is (`Error`, etc.), the subjective decision is to be conservative and strictly compare.\n        // In all cases, these decisions should be reevaluated based on changes to the language and\n        // common development practices.\n        return false;\n    };\n}\n/**\n * Create the configuration object used for building comparators.\n */\nfunction createEqualityComparatorConfig(_a) {\n    var circular = _a.circular, createCustomConfig = _a.createCustomConfig, strict = _a.strict;\n    var config = {\n        areArraysEqual: strict\n            ? areObjectsEqualStrict\n            : areArraysEqual,\n        areDatesEqual: areDatesEqual,\n        areMapsEqual: strict\n            ? combineComparators(areMapsEqual, areObjectsEqualStrict)\n            : areMapsEqual,\n        areObjectsEqual: strict\n            ? areObjectsEqualStrict\n            : areObjectsEqual,\n        arePrimitiveWrappersEqual: arePrimitiveWrappersEqual,\n        areRegExpsEqual: areRegExpsEqual,\n        areSetsEqual: strict\n            ? combineComparators(areSetsEqual, areObjectsEqualStrict)\n            : areSetsEqual,\n        areTypedArraysEqual: strict\n            ? areObjectsEqualStrict\n            : areTypedArraysEqual,\n    };\n    if (createCustomConfig) {\n        config = assign({}, config, createCustomConfig(config));\n    }\n    if (circular) {\n        var areArraysEqual$1 = createIsCircular(config.areArraysEqual);\n        var areMapsEqual$1 = createIsCircular(config.areMapsEqual);\n        var areObjectsEqual$1 = createIsCircular(config.areObjectsEqual);\n        var areSetsEqual$1 = createIsCircular(config.areSetsEqual);\n        config = assign({}, config, {\n            areArraysEqual: areArraysEqual$1,\n            areMapsEqual: areMapsEqual$1,\n            areObjectsEqual: areObjectsEqual$1,\n            areSetsEqual: areSetsEqual$1,\n        });\n    }\n    return config;\n}\n/**\n * Default equality comparator pass-through, used as the standard `isEqual` creator for\n * use inside the built comparator.\n */\nfunction createInternalEqualityComparator(compare) {\n    return function (a, b, _indexOrKeyA, _indexOrKeyB, _parentA, _parentB, state) {\n        return compare(a, b, state);\n    };\n}\n/**\n * Create the `isEqual` function used by the consuming application.\n */\nfunction createIsEqual(_a) {\n    var circular = _a.circular, comparator = _a.comparator, createState = _a.createState, equals = _a.equals, strict = _a.strict;\n    if (createState) {\n        return function isEqual(a, b) {\n            var _a = createState(), _b = _a.cache, cache = _b === void 0 ? circular ? new WeakMap() : undefined : _b, meta = _a.meta;\n            return comparator(a, b, {\n                cache: cache,\n                equals: equals,\n                meta: meta,\n                strict: strict,\n            });\n        };\n    }\n    if (circular) {\n        return function isEqual(a, b) {\n            return comparator(a, b, {\n                cache: new WeakMap(),\n                equals: equals,\n                meta: undefined,\n                strict: strict,\n            });\n        };\n    }\n    var state = {\n        cache: undefined,\n        equals: equals,\n        meta: undefined,\n        strict: strict,\n    };\n    return function isEqual(a, b) {\n        return comparator(a, b, state);\n    };\n}\n\n/**\n * Whether the items passed are deeply-equal in value.\n */\nvar deepEqual = createCustomEqual();\n/**\n * Whether the items passed are deeply-equal in value based on strict comparison.\n */\nvar strictDeepEqual = createCustomEqual({ strict: true });\n/**\n * Whether the items passed are deeply-equal in value, including circular references.\n */\nvar circularDeepEqual = createCustomEqual({ circular: true });\n/**\n * Whether the items passed are deeply-equal in value, including circular references,\n * based on strict comparison.\n */\nvar strictCircularDeepEqual = createCustomEqual({\n    circular: true,\n    strict: true,\n});\n/**\n * Whether the items passed are shallowly-equal in value.\n */\nvar shallowEqual = createCustomEqual({\n    createInternalComparator: function () { return sameValueZeroEqual; },\n});\n/**\n * Whether the items passed are shallowly-equal in value based on strict comparison\n */\nvar strictShallowEqual = createCustomEqual({\n    strict: true,\n    createInternalComparator: function () { return sameValueZeroEqual; },\n});\n/**\n * Whether the items passed are shallowly-equal in value, including circular references.\n */\nvar circularShallowEqual = createCustomEqual({\n    circular: true,\n    createInternalComparator: function () { return sameValueZeroEqual; },\n});\n/**\n * Whether the items passed are shallowly-equal in value, including circular references,\n * based on strict comparison.\n */\nvar strictCircularShallowEqual = createCustomEqual({\n    circular: true,\n    createInternalComparator: function () { return sameValueZeroEqual; },\n    strict: true,\n});\n/**\n * Create a custom equality comparison method.\n *\n * This can be done to create very targeted comparisons in extreme hot-path scenarios\n * where the standard methods are not performant enough, but can also be used to provide\n * support for legacy environments that do not support expected features like\n * `RegExp.prototype.flags` out of the box.\n */\nfunction createCustomEqual(options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.circular, circular = _a === void 0 ? false : _a, createCustomInternalComparator = options.createInternalComparator, createState = options.createState, _b = options.strict, strict = _b === void 0 ? false : _b;\n    var config = createEqualityComparatorConfig(options);\n    var comparator = createEqualityComparator(config);\n    var equals = createCustomInternalComparator\n        ? createCustomInternalComparator(comparator)\n        : createInternalEqualityComparator(comparator);\n    return createIsEqual({ circular: circular, comparator: comparator, createState: createState, equals: equals, strict: strict });\n}\n\nexport { circularDeepEqual, circularShallowEqual, createCustomEqual, deepEqual, sameValueZeroEqual, shallowEqual, strictCircularDeepEqual, strictCircularShallowEqual, strictDeepEqual, strictShallowEqual };\n//# sourceMappingURL=index.mjs.map\n","/* eslint-disable @typescript-eslint/ban-types, @typescript-eslint/naming-convention */\nimport { deepEqual } from 'fast-equals'\nimport { css, html, LitElement } from 'lit'\nimport { customElement, property, query } from 'lit/decorators'\n\nimport { MiniNodeType } from './MiniNode'\nimport { px } from './utils'\n\n@customElement('minimap-component')\nexport class Minimap extends LitElement {\n    @property({ type: Number }) size = 200\n    @property({ type: Number }) ratio = 1\n    @property({\n      type: Array,\n      hasChanged: (newVal: MiniNodeType[], oldVal: MiniNodeType[]) => {\n        return !deepEqual(newVal, oldVal)\n      }\n    })\n      nodes: MiniNodeType[] | undefined\n    @property({ type: Object }) viewport: any\n    @property({ type: Function }) reTranslate = () => {\n      throw new Error('reTranslate not set properly')\n    }\n    @property({ type: Function }) point = (_x: number, _y: number) => {\n      throw new Error('point not defined Properly')\n    }\n    @property({ type: Number }) seed: number | undefined\n\n    @query('.minimap') container: HTMLElement | undefined\n\n    static styles = css`\n        .minimap {\n            position: absolute;\n            right: 24px;\n            bottom: 24px;\n            background: rgba(229, 234, 239, 0.65);\n            padding: 20px;\n            overflow: hidden;\n            border: 1px solid #b1b7ff;\n            border-radius: 8px;\n            box-sizing: border-box;\n        }\n    `\n\n    render() {\n      return html`\n            <div\n                class=\"minimap\"\n                style=\"width: ${px(this.size * this.ratio)}; height: ${px(\n  this.size\n)}\"\n                @pointerdown=\"${this.stopEvent}\"\n                @dblclick=\"${this.dblclick}\"\n                data-testid=\"minimap\"\n            >\n                ${this.nodes?.map(\n    (node) => html`\n                        <mini-node\n                            .left=\"${this.scale(node.left)}\"\n                            .top=\"${this.scale(node.top)}\"\n                            .width=\"${this.scale(node.width)}\"\n                            .height=\"${this.scale(node.height)}\"\n                        ></mini-node>\n                    `\n  )}\n                <mini-viewport\n                    .left=\"${this.viewport.left}\"\n                    .top=\"${this.viewport.top}\"\n                    .width=\"${this.viewport.width}\"\n                    .height=\"${this.viewport.height}\"\n                    .containerWidth=\"${this.container &&\n                    this.container.clientWidth}\"\n                    .reTranslate=\"${this.reTranslate}\"\n                ></mini-viewport>\n            </div>\n        `\n    }\n\n    stopEvent(e: Event) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n\n    dblclick(e: MouseEvent) {\n      if (!this.container) return\n      const box = this.container.getBoundingClientRect()\n      const x = (e.clientX - box.left) / (this.size * this.ratio)\n      const y = (e.clientY - box.top) / (this.size * this.ratio)\n\n      this.point?.(x, y)\n    }\n\n    scale(value: number) {\n      if (!this.container) return 0\n\n      return value * this.container.clientWidth\n    }\n}\n","import './MiniNode'\nimport './MiniViewport'\n\nimport { BaseSchemes } from 'rete'\n\nimport { RenderPreset } from '../types'\nimport { Minimap } from './Minimap'\nimport { MinimapRender } from './types'\n\nexport function setup<Schemes extends BaseSchemes, K extends MinimapRender>(props?: { size?: number }): RenderPreset<Schemes, K> {\n  return {\n    update(context) {\n      if (context.data.type === 'minimap') {\n        return {\n          nodes: context.data.nodes,\n          size: props?.size || 200,\n          ratio: context.data.ratio,\n          viewport: context.data.viewport,\n          reTranslate: context.data.translate,\n          point: context.data.point\n        }\n      }\n    },\n    render(context) {\n      if (context.data.type === 'minimap') {\n        return {\n          component: Minimap,\n          props: {\n            nodes: context.data.nodes,\n            size: props?.size || 200,\n            ratio: context.data.ratio,\n            viewport: context.data.viewport,\n            reTranslate: context.data.translate,\n            point: context.data.point\n          }\n        }\n      }\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { css, html, LitElement } from 'lit'\nimport { customElement, property } from 'lit/decorators'\n\nimport { Pin } from './types'\n\n@customElement('pins-component')\nexport class Pins extends LitElement {\n  @property({ type: Array }) pins: Pin[] = []\n  @property({ type: Function }) menu = (_id: string) => {throw new Error('menu not set properly')}\n  @property({ type: Function }) reTranslate = (_id: string, _dx: number, _dy: number) => {throw new Error('reTranslate not set properly')}\n  @property({ type: Function }) down = (_id: string) => {throw new Error('down not set properly')}\n  @property({ type: Function }) getPointer = () => {throw new Error('getPointer not set properly')}\n\n  static styles = css`\n    :host {\n      display: block;\n    }\n  `\n\n  render() {\n    return html`\n      ${this.pins.map(\n    pin => html`\n          <pin-component\n            .position=${pin.position}\n            .selected=${pin.selected}\n            .getPointer=${this.getPointer}\n            @menu=${() => this.menu(pin.id)}\n            @translate=${(e: CustomEvent) => this.reTranslate(pin.id, e.detail.dx, e.detail.dy)}\n            @down=${() => this.down(pin.id)}\n          ></pin-component>\n        `\n  )}\n    `\n  }\n}\n","import { BaseSchemes } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { RenderPreset } from '../types'\nimport { Pins } from './Pins'\nimport { PinsRender } from './types'\n\ntype Props = {\n  translate?: (id: string, dx: number, dy: number) => void\n  contextMenu?: (id: string) => void\n  pointerdown?: (id: string) => void\n}\n\n/**\n * Preset for rendering pins.\n */\nexport function setup<Schemes extends BaseSchemes, K extends PinsRender>(props?: Props): RenderPreset<Schemes, K> {\n  const getProps = () => ({\n    menu: props?.contextMenu || (() => null),\n    translate: props?.translate || (() => null),\n    down: props?.pointerdown || (() => null)\n  })\n\n  return {\n    update(context) {\n      if (context.data.type === 'reroute-pins') {\n        return {\n          ...getProps(),\n          pins: context.data.data.pins\n        }\n      }\n    },\n    render(context, plugin) {\n      if (context.data.type === 'reroute-pins') {\n        const area = plugin.parentScope<BaseAreaPlugin<Schemes, PinsRender>>(BaseAreaPlugin)\n\n        return {\n          component: Pins,\n          props: {\n            ...getProps(),\n            getPointer: () => area.area.pointer,\n            pins: context.data.data.pins\n          }\n        }\n      }\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/ban-types  */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { css, html, LitElement } from 'lit'\nimport { customElement, property, query } from 'lit/decorators'\n\n@customElement('ref-element')\nexport class RefElement extends LitElement {\n    @property({ type: Object }) data = {}\n    @property({ type: Function }) emit = (_payload: Object) => {\n      throw new Error('emit not set properly')\n    }\n\n    @query('#element') element: HTMLElement | undefined\n\n    originalElementsFromPoint = document.elementsFromPoint.bind(document)\n\n    updated() {\n      this.emit({\n        type: 'render',\n        data: { ...this.data, element: this.element }\n      })\n    }\n\n    disconnectedCallback() {\n      this.emit({ type: 'unmount', data: { element: this.element } })\n      super.disconnectedCallback()\n    }\n\n    handlePointerDown() {\n      // Stash original function\n      const originalElementsFromPoint = this.originalElementsFromPoint\n\n      // Monkey patch\n      document.elementsFromPoint = function (x, y) {\n        const elements = originalElementsFromPoint(x, y)\n        let shadowElements: Element[] = []\n\n        let shadowRoot = elements[0].shadowRoot\n        let d = 0\n\n        while (shadowRoot) {\n          const innerElements: Element[] = shadowRoot.elementsFromPoint(x, y)\n\n          d++\n          shadowElements = innerElements.concat(shadowElements)\n          shadowRoot = innerElements[0]?.shadowRoot // Only check the shadow root of the first element\n          if (d > 5) break\n        }\n\n        return Array.from(new Set(shadowElements.concat(elements)))\n      }\n\n      // eslint-disable-next-line\n        console.log(\"ref pointerdown\");\n    }\n\n    handlePointerUp() {\n      // Restore original function after a setImmediate\n      setTimeout(() => {\n        document.elementsFromPoint = this.originalElementsFromPoint\n      }, 0)\n\n      // eslint-disable-next-line\n        console.log(\"ref pointerup\");\n    }\n\n    render() {\n      return html`<div\n            id=\"element\"\n            @pointerdown=\"${this.handlePointerDown}\"\n            @pointerup=\"${this.handlePointerUp}\"\n            .data=${this.data}\n        ></div>`\n    }\n\n    static styles = css`\n        /* Add your styles here */\n    `\n}\n","import { BaseSchemes, CanAssignSignal, Scope } from 'rete'\n\nimport { RenderPreset } from './presets/types'\nimport { getRenderer, Renderer } from './renderer'\nimport { Position, RenderSignal } from './types'\n\nexport * as Presets from './presets'\nexport type { ClassicScheme, LitArea2D } from './presets/classic/types'\nexport type { RenderPreset } from './presets/types'\nexport { RefElement as Ref } from './Ref'\n\nexport type Produces<Schemes extends BaseSchemes> =\n  | { type: 'connectionpath', data: { payload: Schemes['Connection'], path?: string, points: Position[] } }\n\ntype Requires<Schemes extends BaseSchemes> =\n  | RenderSignal<'node', { payload: Schemes['Node'] }>\n  | RenderSignal<'connection', { payload: Schemes['Connection'], start?: Position, end?: Position }>\n  | { type: 'unmount', data: { element: HTMLElement } }\n\nexport class LitPlugin<Schemes extends BaseSchemes, T = Requires<Schemes>> extends Scope<Produces<Schemes>, [Requires<Schemes> | T]> {\n  renderer: Renderer<unknown>\n  presets: RenderPreset<Schemes, T>[] = []\n  owners = new WeakMap<HTMLElement, RenderPreset<Schemes, T>>()\n\n  constructor() {\n    super('lit-render')\n    this.renderer = getRenderer()\n\n    this.addPipe(context => {\n      if (!context || typeof context !== 'object' || !('type' in context)) return context\n\n      if (context.type === 'unmount') {\n        this.unmount(context.data.element)\n      } else if (context.type === 'render') {\n        if ('filled' in context.data && context.data.filled) {\n          return context\n        }\n        if (this.mount(context.data.element, context as T)) {\n          return {\n            ...context,\n            data: {\n              ...context.data,\n              filled: true\n            }\n          } as typeof context\n        }\n      }\n\n      return context\n    })\n  }\n\n  setParent(scope: Scope<Requires<Schemes> | T>): void {\n    super.setParent(scope)\n\n    this.presets.forEach(preset => {\n      if (preset.attach) preset.attach(this)\n    })\n  }\n\n  private unmount(element: HTMLElement) {\n    this.owners.delete(element)\n    this.renderer.unmount(element)\n  }\n\n  private mount(element: HTMLElement, context: T) {\n    const existing = this.renderer.get(element)\n    const parent = this.parentScope()\n\n    if (existing) {\n      this.presets.forEach(preset => {\n        if (this.owners.get(element) !== preset) return\n        const result = preset.update(context as Extract<T, { type: 'render' }>, this)\n\n        if (result) {\n          this.renderer.update(existing, result)\n        }\n      })\n      return true\n    }\n\n    for (const preset of this.presets) {\n      const result = preset.render(context as Extract<T, { type: 'render' }>, this)\n\n      if (!result) continue\n\n      this.renderer.mount(\n        element,\n        result.component,\n        result.props!,\n        () => parent?.emit({ type: 'rendered', data: (context as Requires<Schemes>).data } as T)\n      )\n\n      this.owners.set(element, preset)\n      return true\n    }\n  }\n\n  public addPreset<K>(preset: RenderPreset<Schemes, CanAssignSignal<T, K> extends true ? K : 'Cannot apply preset. Provided signals are not compatible'>) {\n    const local = preset as RenderPreset<Schemes, T>\n\n    if (local.attach) local.attach(this)\n    this.presets.push(local)\n  }\n}\n"],"names":["setProps","element","payload","_i","_Object$keys","Object","keys","length","key","getRenderer","instances","Map","get","mount","litComponent","onRendered","app","component","state","addEventListener","appendChild","create","set","update","instance","_objectSpread","requestUpdate","unmount","remove","Connection","_decorate","customElement","_initialize","_LitElement","_LitElement2","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","args","Array","_key","call","apply","this","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","property","type","value","String","static","css","_templateObject","_taggedTemplateLiteral","html","_templateObject2","path","LitElement","ConnectionWrapper","_fetchPath","Function","Error","x","y","_get","_getPrototypeOf","prototype","initializeWatchers","fetchPath","onDestroy","_this2","unwatch1","start","pos","observedStart","unwatch2","end","observedEnd","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","startPosition","endPosition","observedPath","sent","stop","dynamicComponent","data","vars$1","Control","ClassicPreset","InputControl","vars","_this$data","_this$data2","_this$data3","readonly","change","stopEvent","e","_this$data4","_e$target","_e$target2","_this$data5","val","target","setValue","stopPropagation","sortByIndex","entries","undefined","sort","a","b","index","customElements","define","Node","width","height","inputs","controls","outputs","_this$data6","_this$data7","selected","nodeStyles","label","map","_ref","_this2$data","_ref2","_slicedToArray","output","_templateObject3","side","nodeId","id","socket","emit","_ref3","_ref4","control","_templateObject4","_ref5","_this2$data2","_ref6","input","_templateObject5","showControl","Socket","console","log","name","handleClick","props","positionWatcher","socketPositionWatcher","getDOMSocketPosition","customize","node","connection","attach","plugin","context","parent","parentScope","bind","_context$data","render","_path","source","sourceOutput","targetInput","listen","response","_response$data","points","curvature","abrupt","isLoop","loopConnectionPath","classicConnectionPath","_x","_x2","debounce","delay","cb","timeout","cancel","window","clearTimeout","setTimeout","Block","Item","hide","hideSubitems","Number","Boolean","visibleSubitems","subitems","event","dispatchEvent","CustomEvent","detail","item","handler","Search","text","handleInput","Menu","onHide","filterRegexp","RegExp","filter","items","match","searchBar","getItems","px","MiniNode","left","top","styleMap","styles","MiniViewport","_y","translate","onDrag","getPointer","pageX","pageY","previous","move","moveEvent","current","dx","dy","up","removeEventListener","v","containerWidth","reTranslate","invert","scale","drag","getOwnPropertyNames","getOwnPropertySymbols","hasOwnProperty","combineComparators","comparatorA","comparatorB","createIsCircular","areItemsEqual","cache","cachedA","cachedB","result","delete","getStrictProperties","object","hasOwn","sameValueZeroEqual","OWNER","getOwnPropertyDescriptor","areArraysEqual","equals","areDatesEqual","getTime","areMapsEqual","size","aResult","bResult","matchedIndices","aIterable","done","bIterable","hasMatch","matchIndex","_a","aKey","aValue","_b","bKey","bValue","areObjectsEqual","properties","$$typeof","areObjectsEqualStrict","descriptorA","descriptorB","configurable","enumerable","writable","arePrimitiveWrappersEqual","valueOf","areRegExpsEqual","flags","areSetsEqual","values","areTypedArraysEqual","ARGUMENTS_TAG","BOOLEAN_TAG","DATE_TAG","MAP_TAG","NUMBER_TAG","OBJECT_TAG","REG_EXP_TAG","SET_TAG","STRING_TAG","isArray","isTypedArray","ArrayBuffer","isView","assign","getTag","toString","deepEqual","createCustomEqual","options","compare","circular","createCustomInternalComparator","createInternalComparator","createState","strict","config","createCustomConfig","areArraysEqual$1","areMapsEqual$1","areObjectsEqual$1","areSetsEqual$1","createEqualityComparatorConfig","comparator","constructor","Date","Set","tag","then","createEqualityComparator","WeakMap","meta","createIsEqual","_indexOrKeyA","_indexOrKeyB","_parentA","_parentB","Minimap","hasChanged","newVal","oldVal","query","_this$nodes","ratio","dblclick","nodes","viewport","container","clientWidth","preventDefault","_this$point","box","getBoundingClientRect","clientX","clientY","point","Pins","_id","_dx","_dy","pins","pin","position","menu","down","getProps","contextMenu","pointerdown","area","BaseAreaPlugin","pointer","RefElement","_payload","document","elementsFromPoint","originalElementsFromPoint","elements","shadowElements","shadowRoot","_innerElements$","innerElements","from","handlePointerDown","handlePointerUp","LitPlugin","_Scope","_defineProperty","renderer","addPipe","_typeof","filled","scope","presets","forEach","preset","owners","_this3","existing","_step","_iterator","_createForOfIteratorHelper","s","n","err","f","local","push","Scope"],"mappings":"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"}